<view class="favorites-container">
  <view class="header">
    <text class="title">我的收藏</text>
  </view>
  
  <view class="loading" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text>加载中...</text>
  </view>
  
  <view class="empty-tip" wx:elif="{{isEmpty}}">
    <image class="empty-icon" src="../../images/empty-box.svg"></image>
    <text>暂无收藏的宝藏</text>
    <view class="tip-action">
      <text>去地图页找一找吧！</text>
      <navigator url="/pages/map/map" open-type="switchTab" class="nav-btn">去看看</navigator>
    </view>
  </view>
  
  <view class="favorites-list" wx:else>
    <view class="favorite-item" wx:for="{{favorites}}" wx:key="id">
      <view class="favorite-content">
        <view class="favorite-info">
          <text class="favorite-name">{{item.name}}</text>
          <text class="favorite-desc">{{item.description}}</text>
          <view class="favorite-meta">
            <text class="favorite-points">奖励: {{item.points}}积分</text>
            <text class="favorite-date">收藏于 {{formatTime(item.timestamp)}}</text>
          </view>
        </view>
      </view>
      
      <view class="favorite-actions">
        <button class="action-btn view" bindtap="viewOnMap" data-id="{{item.id}}">在地图查看</button>
        <button class="action-btn remove" bindtap="removeFavorite" data-id="{{item.id}}">取消收藏</button>
      </view>
    </view>
  </view>
</view>

<wxs module="formatTime">
  function formatTime(timestamp) {
    if (!timestamp) return '';
    var date = getDate(timestamp);
    var month = date.getMonth() + 1;
    var day = date.getDate();
    var hour = date.getHours();
    var minute = date.getMinutes();
    
    month = month < 10 ? '0' + month : month;
    day = day < 10 ? '0' + day : day;
    hour = hour < 10 ? '0' + hour : hour;
    minute = minute < 10 ? '0' + minute : minute;
    
    return month + '-' + day + ' ' + hour + ':' + minute;
  }
  
  module.exports = formatTime;
</wxs> 